<?xml version="1.0" encoding="UTF-8"?>
<!--
 Fabric3
 Copyright (c) 2009-2011 Metaform Systems

 Fabric3 integration tests are licensed under the Apache 2.0 license.

-->
<composite xmlns="http://docs.oasis-open.org/ns/opencsa/sca/200912"
           xmlns:sca="http://docs.oasis-open.org/ns/opencsa/sca/200912"
           xmlns:f3="urn:fabric3.org"
           targetNamespace="urn:fabric3.org"
           name="TestComposite"
           autowire="true">

    <component name="TestInputOutputClient">
        <f3:junit class="org.fabric3.binding.file.test.TestInputOutputClient"/>
        <reference name="latchService" target="FileService/LatchService"/>
    </component>

    <component name="TestServiceAdapterClient">
        <f3:junit class="org.fabric3.binding.file.test.TestServiceAdapterClient"/>
        <reference name="latchService" target="AdaptedFileService/LatchService"/>
    </component>

    <component name="TestReferenceAdapterClient">
        <f3:junit class="org.fabric3.binding.file.test.TestReferenceAdapterClient"/>
    </component>

    <component name="FileService">
        <implementation.java class="org.fabric3.binding.file.test.FileServiceImpl"/>
        <service name="FileService">
            <f3:binding.file location="drop" error.location="droperror" delay="200"/>
        </service>
        <reference name="output">
            <f3:binding.file location="dropoutput"/>
        </reference>
    </component>

    <component name="AdaptedFileService">
        <implementation.java class="org.fabric3.binding.file.test.AdaptedFileServiceImpl"/>
        <service name="AdaptedFileService">
            <f3:binding.file location="adapterdrop"
                             pattern="header.*\.xml"
                             error.location="adapterdroperror"
                             archive.location="adapterarchive"
                             strategy="archive"
                             delay="200"
                             adapter="org.fabric3.binding.file.test.TestServiceAdapter"/>
        </service>
    </component>

    <component name="OutputService">
        <implementation.java class="org.fabric3.binding.file.test.OutputServiceImpl"/>
        <reference name="output">
            <f3:binding.file location="customoutput"/>
        </reference>
    </component>


</composite>
